# Колесо Фортуны - Архитектура

## Обзор

Компонент колеса фортуны реализован по принципам MVVM архитектуры и следует структуре из Next.js проекта. Компонент позволяет пользователям участвовать в игре с колесом фортуны, где сектора представляют фильмы.

## Структура файлов

```
Features/Wheel/
├── Models/
│   ├── Wheel.swift              # Модель колеса
│   ├── Sector.swift             # Модель сектора
│   ├── WheelTheme.swift         # Модель темы
│   ├── WheelState.swift         # Состояние игры
│   └── WheelStatus.swift        # Статусы колеса
├── ViewModels/
│   └── FortuneWheelViewModel.swift  # ViewModel для управления состоянием
├── Views/
│   ├── FortuneWheelGameView.swift   # Основной экран игры
│   └── Components/
│       ├── FortuneWheelView.swift   # Компонент колеса
│       ├── SectorsTableView.swift   # Таблица секторов
│       ├── UsersPanelView.swift     # Панель пользователей
│       └── WheelControlsView.swift  # Управление колесом
└── Services/
    └── FortuneWheelService.swift    # API сервис
```

## Компоненты

### 1. FortuneWheelGameView

Основной экран игры, который объединяет все компоненты:

- Видео фон
- Заголовок с информацией о победителе
- Панель пользователей
- Колесо фортуны
- Управление
- Таблицы секторов

### 2. FortuneWheelView

Компонент колеса с анимацией:

- Отображение секторов с цветами
- Анимация вращения
- Указатель
- Экран победителя
- Центральная кнопка

### 3. SectorsTableView

Таблица для отображения секторов:

- Активные фильмы
- Выбывшие фильмы
- Статусы секторов (победитель, выбывший)

### 4. UsersPanelView

Панель участников:

- Список пользователей в комнате
- Аватары и имена
- Количество монет

### 5. WheelControlsView

Управление игрой:

- Кнопка вращения
- Кнопка перемешивания
- Настройка скорости
- Автоматическое вращение
- Информация о монетах

## Модели данных

### WheelState

Управляет состоянием игры:

- Сектора и выбывшие
- Вращение и скорость
- Настройки темы
- Колбэки для API

### FortuneWheelViewModel

ViewModel для управления:

- Состояние игры
- Пользователи
- Видео фон
- API вызовы

## Архитектурные принципы

1. **MVVM**: Разделение логики (ViewModel) и представления (Views)
2. **Single Responsibility**: Каждый компонент отвечает за одну задачу
3. **ObservableObject**: Использование @Published для реактивности
4. **Dependency Injection**: Сервисы передаются через инициализаторы
5. **Async/Await**: Современный подход к асинхронным операциям

## Использование

```swift
FortuneWheelGameView(
    wheelData: wheelWithRelations,
    currentUser: currentUser
)
```

## Особенности

- Адаптивный размер колеса
- Видео фон с зацикливанием
- Анимации вращения
- Управление состоянием игры
- Поддержка тем оформления
- Интеграция с API

## Расширение

Для добавления новых функций:

1. Создать новые модели в папке Models
2. Добавить методы в FortuneWheelService
3. Обновить FortuneWheelViewModel
4. Создать новые компоненты в Views/Components
5. Интегрировать в основной экран
